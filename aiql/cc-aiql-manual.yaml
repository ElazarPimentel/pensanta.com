# AIQL - Claude Code Integration Guide
# This file explains how Claude Code should work with AIQL

## What is AIQL?
AIQL is a collaborative database interface that allows you (Claude Code) and
the user to work together on database tasks through shared files.

## The Workflow

### 1. Read the aiql.json file
When you start, read the `aiql.json` file in this directory to understand:
- sourceFile: Where you should write SQL queries
- outputFile: Where you read query results
- dbType: Type of database (postgresql/mysql/mariadb/api-remote)
- databaseName: Which database you're working with
- host: Database server or API endpoint
- username: Database username (NO password in this file)

### 2. When the user asks a database question

Example: "Show me all tables in the database"

You should:
1. Read aiql.json to get the sourceFile path
2. Write appropriate SQL to that file (e.g., `SHOW TABLES;` for MySQL)
3. Tell the user: "SQL query written! Click 'Run SQL' (F5) when ready."
4. Wait for user to execute the query

### 3. After the user runs the query

The user clicks "Run SQL" (F5) in AIQL, which:
1. Reads SQL from sourceFile
2. Executes it against the database
3. Writes results to outputFile

### 4. Read and discuss results

You should:
1. Read the outputFile to see the query results
2. Analyze and discuss the results with the user
3. Answer follow-up questions or suggest next steps

### 5. Iterate

Continue this loop:
- User asks question → You write SQL → User runs it → You read results → Discuss

## Important Notes for Claude Code

### Files You Work With
- `aiql.json` - Read this first! Contains all setup info
- Source file (from aiql.json) - Write SQL queries here
- Output file (from aiql.json) - Read results from here

### What You Should Do
- Always read aiql.json to understand the current setup
- Write clear, well-commented SQL queries
- Tell user to click "Run SQL" after writing queries
- Read and analyze results from the output file
- Suggest optimizations and next steps

### What You Should NOT Do
- Never try to execute SQL yourself (user does this via AIQL)
- Never try to connect to databases directly
- Never include passwords in any files
- Never modify aiql.json (AIQL manages this)

## Example Session

```
User: "What tables exist in this database?"

Claude Code:
1. Reads aiql.json
2. Sees dbType is "mysql"
3. Writes to sourceFile:
   -- Show all tables in database
   SHOW TABLES;
4. Says: "I've written a query to list all tables. Click 'Run SQL' (F5) to execute it."

User: *clicks Run SQL button*

AIQL: *executes query, writes results to outputFile*

Claude Code:
1. Reads outputFile
2. Sees list of tables
3. Says: "Your database has 15 tables: users, products, orders, ..."
4. Suggests: "Would you like to see the structure of any specific table?"
```

## File Locations

Current working directory: /home/rob/Documents/work/pensanta/websites/ayudem/aiql
- aiql.json: Configuration handshake file
- cc-aiql-manual.yaml: This guide file

User's home directory (~/.aiql/):
- profiles.json: Connection profiles (contains passwords - never read this)
- history.db: File/command history (you don't need this)
- active.json: Active profile info (you don't need this)

## Keyboard Shortcuts for User

- F5 or Ctrl+R: Run SQL query
- Ctrl+S: Save current tab

## Profile Types

- **postgresql**: PostgreSQL database (uses psql command)
- **mysql**: MySQL database (uses mysql command)
- **mariadb**: MariaDB database (uses mysql command)
- **api-remote**: Remote API endpoint (uses HTTP POST to execute SQL)

## Tips for Claude Code

1. **Always check aiql.json first** - It tells you everything about the current setup
2. **Write defensive SQL** - Include error handling and comments
3. **Explain your queries** - Help user understand what the SQL does
4. **Suggest optimizations** - If you see inefficient patterns, mention them
5. **Be patient** - Wait for user to run queries, don't try to execute them yourself

## Need Help?

- Website: https://elazarpimentel.com/en/tools/aiql
- GitHub: https://github.com/ElazarPimentel/aiql
